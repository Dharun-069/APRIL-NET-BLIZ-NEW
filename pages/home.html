<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link rel="stylesheet" href="../assets/css/home.css">
    <link rel="stylesheet" href="../assets/css/common_style.css">
</head>

<body>




    <header>
        <div class="title">
            <a href="">NET BANKING</a>
        </div>

        <div class="full_link">
            <div>
                <a class="current_page" href="#">Home</a>
            </div>


            <div>
                <a href="./fund_transfer.html">Transfer</a>
            </div>


            <div>
                <a href="./balance_enquire.html">Balance</a>
            </div>

            <div>
                <a href="./history.html">History</a>
            </div>





            <div class="logout">
                <a href="../index.html">Log Out</a>
            </div>
        </div>


    </header>

    <main>

        <div class="welcome">

            <div class="welcome_sms">
                <span>Welcome</span>
                <span id="fname"></span>
            </div>

            <div class="search">
                <img src="../assets/img/5138de707a808fdcb21f8190a417a259.png_wh860-removebg-preview.png" alt="search">
                <label for="search"></label>
                <input type="search" id="search" name="search" placeholder="Search here">

            </div>

            <a href="../pages/account_detail.html">
                <div class="profile">
                    <img src="../assets/img/icons8-user-100.png" alt="account">
                    <div class="detail">
                        <span id="fname"></span>
                        <span>customer</span>
                    </div>

                </div>
            </a>

        </div>

        <!-- link bank account 1st container ** -->

        <div class="back_link">

            <img src="../assets/img/202101-Talent-Trends-2_xxpjxy.gif" alt="intro">
            <div class="link_bank">

                <h2>Link a bank account</h2>
                <p>You'll need to link and confirm to our bank account before you can receive Payment with Banking.
                    We'll automatically withdraw the funds in your netbanking account to the bank account </p>
                <form>
                    <label for="account"> Account number </label>
                    <input class="form-control" type="text" id="account" name="account" required>

                    <label for="ifsc"> IFSC code </label>
                    <input class="form-control" type="text" id="ifsc" name="ifsc" required>

                    <label for="phone">Phone number</label>
                    <input class="form-control" type="number" id="phone" name="phone" required>

                    <label for="pincode"> Pin code</label>
                    <input class="form-control" type="text" id="pincode" name="pincode" required>



                    <h5>Account name</h5>

                    <input type="radio" name="detail" id="personal"> <label for="personal">Personal Account</label> <br>
                    <input type="radio" name="detail" id="business"> <label for="business">Business Account</label> <br>
                    <input type="radio" name="detail" id="savings"> <label for="savings">Savings Account</label> <br>

                    <p>Remember to double-check your account number . Banks may not flag wrrors untol you transfer funds
                    </p>

                    <button class="btn btn-primary">Link Your Bank</button>

                </form>
            </div>

        </div>

        <div class="bank_account remove_hide" id="bank_account">

            <!-- <div class="bank">
                <img src="../assets/img/account.png" alt="account">

                <div>
                    <label for="account_give">Account Number </label>
                    <input class="form-control" type="text" id="account_give" name="account_give" required>
                </div>


                <div>
                    <label for="ifsc_give">IFSC Code</label> <br>
                    <input class="form-control" type="text" id="ifsc_give" name="ifsc_give" required>
                </div>

                <div>
                    <label for="phone_give">Phone no</label> <br>
                    <input class="form-control" type="number" id="phone_give" name="phone_give" required>
                </div>

                <div>
                    <label for="pincode_give">Pincode</label> <br>
                    <input class="form-control" type="text" id="pincode_give" name="pincode_give" required>
                </div>

            </div> -->

        </div>

    </main>

    <footer>

        <div class="back_foot">

            <div class="direct">

                <a href="./pages/signup_page.html">Register</a>
                <a href="./pages/login_page.html">Login</a>
            </div>

            <h3>@ 2023 Net Banking</h3>



            <div class="icon_social">

                <img src="../assets/img/icons8-linkedin-100 (1).png" alt="linked in">
                <img src="../assets/img/icons8-facebook-100.png" alt="facebook">
                <img src="../assets/img/icons8-instagram-100.png" alt="insta">
                <img src="../assets/img/icons8-twitter-100.png" alt="teitter">

            </div>


        </div>

    </footer>

    <script>


        // Header name 

        let show = JSON.parse(localStorage.getItem('array'));

        let account_name = localStorage.getItem("first_name");

        let email_compare = localStorage.getItem("email");

        let btn_submit=document.querySelector("form");
        btn_submit.addEventListener("submit",()=>{

            link_bank();
        })


        let check;

        show.forEach(element => { //[{0},{1},......]

            if (element["email"] === email_compare) { //e=arr[0]

                document.querySelectorAll("#fname")[0].innerText = element["fname"] + ","//[0,1]
                document.querySelectorAll("#fname")[1].innerText = element["fname"]

                localStorage.setItem("array", JSON.stringify(show));
            }
        })




        function link_bank() {

            let account = document.getElementById("account").value.trim();
            let ifsc = document.getElementById("ifsc").value.trim();
            let phone = document.getElementById("phone").value.trim()
            let pincode = document.getElementById("pincode").value.trim()
            let email_compare = localStorage.getItem("email");


            if (account != "" && ifsc != "" && phone != "" && pincode != "") {

                let account_store = {
                    "account": account,
                    "ifsc": ifsc,
                    "phone": phone,
                    "pincode": pincode,
                    "email_compare": email_compare
                }

                let add_account = JSON.parse(localStorage.getItem("account_details")) ?? []; //account = []


                let res = 0;

                for (let i = 0; i < add_account.length; i++) {

                    if (add_account[i]["ifsc"] === ifsc && add_account[i]["account"] === account) {
                        res = 1;
                        break;
                    }
                }

                if (res == 1) {
                    alert(" Invalid IFSC")

                }

                else {

                    add_account.push(account_store);//[{name, email, pass}]

                    localStorage.setItem("account_details", JSON.stringify(add_account)); // account_details  :  [{name, email, pass}]


                    alert("Thanks for add account");

                    window.location.href = "#bank_account"

                }

            }

            else {
                alert("Sorry can't get a value")
            }
        }


        // function link_account() {

            let account_detail = JSON.parse(localStorage.getItem("account_details"))


        for (let i = 0; i < account_detail.length; i++) {

            let account = document.getElementById("account").value.trim();
            let ifsc = document.getElementById("ifsc").value.trim();
            let phone = document.getElementById("phone").value.trim()
            let pincode = document.getElementById("pincode").value.trim()

            let bank_div = document.querySelector("#bank_account");

            let bank = document.createElement("div");
            bank.setAttribute("class", "bank");
            bank_div.append(bank);

            let image = document.createElement("img");
            image.setAttribute("src", "../assets/img/account.png")
            image.setAttribute("alt", "hello");
            bank.append(image);





            let data = [

                {
                    "label": "Account no",
                    "for": "account_give",


                    "type": "text",
                    "id": "account_give",
                    "class": "account_give form-control input_size",
                    "name": "account_give",
                    "place_holder": "Account no",
                    "disable": "disable",


                },

                {
                    "label": "IFSC Code",
                    "for": "ifsc_give",

                    "type": "text",
                    "id": "ifsc_give",
                    "class": "ifsc_give form-control input_size",
                    "name": "ifsc_give",
                    "place_holder": "IFSC Code",
                    "disable": "disable",


                },

                // {
                //     "label": "Phone no",
                //     "for": "phone_give",

                //     "type": "number",
                //     "id": "phone_give",
                //     "name": "phone_give",
                //     "place_holder": "phone_give",
                //     "disable": "disable",


                // },



                // {
                //     "label": "Pin code",
                //     "for": "pincode_give",

                //     "type": "number",
                //     "id": "pincode_give",
                //     "name": "pincode_give",
                //     "place_holder": "Pin code",
                //     "disable": "disable",



                // },



            ]



            for (let i = 0; i < 2; i++) {


                let contant = document.createElement("div");
                contant.setAttribute("class", "form-floating mb-3");
                bank.append(contant);

                let input = document.createElement("input");
                input.setAttribute("type", data[i]["type"]);
                // input.setAttribute("class", "form-control input_size ")
                input.setAttribute("id", data[i]["id"]);
                input.setAttribute("class", data[i]["class"]);
                input.setAttribute("name", data[i]["name"]);
                input.setAttribute("placeholder", data[i]["place_holder"]);
                input.setAttribute("disable", data[i]["disable"]);
                contant.append(input);


                let label = document.createElement("label");
                label.innerText = data[i]["label"];
                label.setAttribute("for", data[i]["for"]);
                contant.append(label);


            }

            let btn = document.createElement("a");
            btn.setAttribute("href", "../index.html");
            btn.innerText = "Remove bank account"
            bank.append(btn);

           

        }




        function show1() {

            let account_details = JSON.parse(localStorage.getItem("account_details"))

            let email_compare = localStorage.getItem("email");

            let k = 0
            account_details.forEach(e => {

                if (email_compare == e["email_compare"]) {

                    document.getElementsByClassName("account_give")[k].value = e["account"]
                    document.getElementsByClassName("ifsc_give")[k].value = e["ifsc"]

                    // console.log(k);

                    k++
                }

            })
        }

        show1();



        // document.getElementById("account_give").value[0] = account_details["account"][0]


            // document.getElementById("account_give").value = value_change["account"]
            // document.getElementById("ifsc_give").value = value_change["ifsc"]
            // document.getElementById("phone_give").value = value_change["phone"]
            // document.getElementById("pincode_give").value = value_change["pincode"]

         // }



            // document.getElementById("account_give").value = account_details["account"][0]
            // document.getElementById("account_give")[1].value = account
            // document.getElementById("ifsc_give").value = ifsc
            // document.getElementById("phone_give").value = phone
            // document.getElementById("pincode_give").value = pincode


    </script>


</body>



</html>